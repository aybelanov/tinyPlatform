@page "/configuration/devices"
@attribute [Authorize(Roles = UserDefaults.TelemetryAdminRoles)]
@implements IDisposable

<PageTitle>@T["Pages.Configuration.Devices"]</PageTitle>

<AuthorizeView>
   <Authorized>
      @if (PermissionService.IsAdminMode(context))
      {
         <RadzenCard>
            <DevicesTable Title="@T["Table.Devices.All"]" Hint="@T["Table.Devices.AdminMode"]" />
         </RadzenCard>
      }
      else
      {
         <RadzenCard class="mb-5">
            <DevicesTable Title="@T["Table.Devices.Own"]" Hint="@T["Table.Devices.Own.Hint"]" />
         </RadzenCard>
         <RadzenCard>
            <SharedDeviceTable Title="@T["Table.Devices.Shared"]" Hint="@T["Table.Devices.Shared.Hint"]" />
         </RadzenCard>
      }
   </Authorized>
</AuthorizeView>

@code {

   [Inject] private PermissionService PermissionService { get; set; }

   protected override void OnInitialized() => PermissionService.AdminModeChanged += OnAdminModeChanged;
   private void OnAdminModeChanged(object sender, bool mode) => StateHasChanged();
   public void Dispose() => PermissionService.AdminModeChanged -= OnAdminModeChanged;
}