/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/ol@8.1.0/TileQueue.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import EventType from"./events/EventType.js";import PriorityQueue,{DROP}from"./structs/PriorityQueue.js";import TileState from"./TileState.js";class TileQueue extends PriorityQueue{constructor(e,t){super((function(t){return e.apply(null,t)}),(function(e){return e[0].getKey()})),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);if(t){e[0].addEventListener(EventType.CHANGE,this.boundHandleTileChange_)}return t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const t=e.target,i=t.getState();if(i===TileState.LOADED||i===TileState.ERROR||i===TileState.EMPTY){i!==TileState.ERROR&&t.removeEventListener(EventType.CHANGE,this.boundHandleTileChange_);const e=t.getKey();e in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[e],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let i,n,s,l=0;for(;this.tilesLoading_<e&&l<t&&this.getCount()>0;)n=this.dequeue()[0],s=n.getKey(),i=n.getState(),i!==TileState.IDLE||s in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++l,n.load())}}export default TileQueue;export function getTilePriority(e,t,i,n,s){if(!e||!(i in e.wantedTiles))return DROP;if(!e.wantedTiles[i][t.getKey()])return DROP;const l=e.viewState.center,a=n[0]-l[0],r=n[1]-l[1];return 65536*Math.log(s)+Math.sqrt(a*a+r*r)/s}
//# sourceMappingURL=/sm/878bfca59fbe93650c5fb4400bde19e4b7f81ee408a8513e10ed4353b30f401d.map