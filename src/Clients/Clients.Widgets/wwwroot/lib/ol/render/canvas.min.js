/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/ol@8.1.0/render/canvas.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import BaseObject from"../Object.js";import{WORKER_OFFSCREEN_CANVAS}from"../has.js";import{clear}from"../obj.js";import{createCanvasContext2D}from"../dom.js";import{getFontParameters}from"../css.js";export const defaultFont="10px sans-serif";export const defaultFillStyle="#000";export const defaultLineCap="round";export const defaultLineDash=[];export const defaultLineDashOffset=0;export const defaultLineJoin="round";export const defaultMiterLimit=10;export const defaultStrokeStyle="#000";export const defaultTextAlign="center";export const defaultTextBaseline="middle";export const defaultPadding=[0,0,0,0];export const defaultLineWidth=1;export const checkedFonts=new BaseObject;let measureFont,measureContext=null;export const textHeights={};export const registerFont=function(){const e="32px ",t=["monospace","serif"],n=t.length,o="wmytzilWMYTZIL@#/&?$%10";let s,r;function a(s,a,i){let c=!0;for(let l=0;l<n;++l){const n=t[l];if(r=measureTextWidth(s+" "+a+" "+e+n,o),i!=n){const t=measureTextWidth(s+" "+a+" "+e+i+","+n,o);c=c&&t!=r}}return!!c}function i(){let e=!0;const t=checkedFonts.getKeys();for(let n=0,o=t.length;n<o;++n){const o=t[n];checkedFonts.get(o)<100&&(a.apply(this,o.split("\n"))?(clear(textHeights),measureContext=null,measureFont=void 0,checkedFonts.set(o,100)):(checkedFonts.set(o,checkedFonts.get(o)+1,!0),e=!1))}e&&(clearInterval(s),s=void 0)}return function(e){const t=getFontParameters(e);if(!t)return;const n=t.families;for(let e=0,o=n.length;e<o;++e){const o=n[e],r=t.style+"\n"+t.weight+"\n"+o;void 0===checkedFonts.get(r)&&(checkedFonts.set(r,100,!0),a(t.style,t.weight,o)||(checkedFonts.set(r,0,!0),void 0===s&&(s=setInterval(i,32))))}}}();export const measureTextHeight=function(){let e;return function(t){let n=textHeights[t];if(null==n){if(WORKER_OFFSCREEN_CANVAS){const e=getFontParameters(t),o=measureText(t,"Žg");n=(isNaN(Number(e.lineHeight))?1.2:Number(e.lineHeight))*(o.actualBoundingBoxAscent+o.actualBoundingBoxDescent)}else e||(e=document.createElement("div"),e.innerHTML="M",e.style.minHeight="0",e.style.maxHeight="none",e.style.height="auto",e.style.padding="0",e.style.border="none",e.style.position="absolute",e.style.display="block",e.style.left="-99999px"),e.style.font=t,document.body.appendChild(e),n=e.offsetHeight,document.body.removeChild(e);textHeights[t]=n}return n}}();function measureText(e,t){return measureContext||(measureContext=createCanvasContext2D(1,1)),e!=measureFont&&(measureContext.font=e,measureFont=measureContext.font),measureContext.measureText(t)}export function measureTextWidth(e,t){return measureText(e,t).width}export function measureAndCacheTextWidth(e,t,n){if(t in n)return n[t];const o=t.split("\n").reduce(((t,n)=>Math.max(t,measureTextWidth(e,n))),0);return n[t]=o,o}export function getTextDimensions(e,t){const n=[],o=[],s=[];let r=0,a=0,i=0,c=0;for(let l=0,u=t.length;l<=u;l+=2){const d=t[l];if("\n"===d||l===u){r=Math.max(r,a),s.push(a),a=0,i+=c;continue}const x=t[l+1]||e.font,m=measureTextWidth(x,d);n.push(m),a+=m;const h=measureTextHeight(x);o.push(h),c=Math.max(c,h)}return{width:r,height:i,widths:n,heights:o,lineWidths:s}}export function rotateAtOffset(e,t,n,o){0!==t&&(e.translate(n,o),e.rotate(t),e.translate(-n,-o))}export function drawImageOrLabel(e,t,n,o,s,r,a,i,c,l,u){e.save(),1!==n&&(e.globalAlpha*=n),t&&e.transform.apply(e,t),o.contextInstructions?(e.translate(c,l),e.scale(u[0],u[1]),executeLabelInstructions(o,e)):u[0]<0||u[1]<0?(e.translate(c,l),e.scale(u[0],u[1]),e.drawImage(o,s,r,a,i,0,0,a,i)):e.drawImage(o,s,r,a,i,c,l,a*u[0],i*u[1]),e.restore()}function executeLabelInstructions(e,t){const n=e.contextInstructions;for(let e=0,o=n.length;e<o;e+=2)Array.isArray(n[e+1])?t[n[e]].apply(t,n[e+1]):t[n[e]]=n[e+1]}
//# sourceMappingURL=/sm/493803bd4c72128a47a637682bd5a5d15c1ebeb9d691abf772e9ed1fff6ecde1.map