/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/ol@8.1.0/source/wms.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{DECIMALS}from"./common.js";import{appendParams}from"../uri.js";import{compareVersions}from"../string.js";import{decode}from"../Image.js";import{getHeight,getWidth}from"../extent.js";import{get as getProjection}from"../proj.js";import{getRequestExtent}from"./Image.js";import{round}from"../math.js";export const DEFAULT_VERSION="1.3.0";export function getRequestUrl(e,r,t,o,s){s.WIDTH=t[0],s.HEIGHT=t[1];const n=o.getAxisOrientation();let i;const a=compareVersions(s.VERSION,"1.3")>=0;return s[a?"CRS":"SRS"]=o.getCode(),i=a&&"ne"==n.substr(0,2)?[r[1],r[0],r[3],r[2]]:r,s.BBOX=i.join(","),appendParams(e,s)}export function getImageSrc(e,r,t,o,s,n,i){n=Object.assign({REQUEST:"GetMap"},n);const a=r/t,g=[round(getWidth(e)/a,DECIMALS),round(getHeight(e)/a,DECIMALS)];if(1!=t)switch(i){case"geoserver":const e=90*t+.5|0;"FORMAT_OPTIONS"in n?n.FORMAT_OPTIONS+=";dpi:"+e:n.FORMAT_OPTIONS="dpi:"+e;break;case"mapserver":n.MAP_RESOLUTION=90*t;break;case"carmentaserver":case"qgis":n.DPI=90*t;break;default:throw new Error("Unknown `serverType` configured")}return getRequestUrl(s,e,g,o,n)}export function getRequestParams(e,r){return Object.assign({REQUEST:r,SERVICE:"WMS",VERSION:DEFAULT_VERSION,FORMAT:"image/png",STYLES:"",TRANSPARENT:!0},e)}export function createLoader(e){const r=void 0===e.hidpi||e.hidpi,t=getProjection(e.projection||"EPSG:3857"),o=e.ratio||1.5,s=e.load||decode;return(n,i,a)=>{n=getRequestExtent(n,i,a,o),1==a||r&&void 0!==e.serverType||(a=1);const g=getImageSrc(n,i,a,t,e.url,getRequestParams(e.params,"GetMap"),e.serverType),m=new Image;return null!==e.crossOrigin&&(m.crossOrigin=e.crossOrigin),s(m,g).then((e=>({image:e,extent:n,pixelRatio:a})))}}
//# sourceMappingURL=/sm/47ce00d302c5eab91272215e90a93dfa4c9b3dd2a593937c14be112b5b990eed.map