/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/ol@8.1.0/source/arcgisRest.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{DECIMALS}from"./common.js";import{appendParams}from"../uri.js";import{decode}from"../Image.js";import{getHeight,getWidth}from"../extent.js";import{get as getProjection}from"../proj.js";import{getRequestExtent}from"./Image.js";import{round}from"../math.js";export function getRequestUrl(e,t,r,o,n,i){const s=n.getCode().split(/:(?=\d+$)/).pop(),a=r/o,p=[round(getWidth(t)/a,DECIMALS),round(getHeight(t)/a,DECIMALS)];i.SIZE=p[0]+","+p[1],i.BBOX=t.join(","),i.BBOXSR=s,i.IMAGESR=s,i.DPI=Math.round(i.DPI?i.DPI*o:90*o);const m=e.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");if(m==e)throw new Error("`options.featureTypes` should be an Array");return appendParams(m,i)}export function createLoader(e){const t=e.load?e.load:decode,r=getProjection(e.projection||"EPSG:3857");return function(o,n,i){i=e.hidpi?i:1;const s={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};Object.assign(s,e.params),o=getRequestExtent(o,n,i,e.ratio);const a=getRequestUrl(e.url,o,n,i,r,s),p=new Image;return null!==e.crossOrigin&&(p.crossOrigin=e.crossOrigin),t(p,a).then((e=>{const t=getWidth(o)/e.width*i;return{image:e,extent:o,resolution:t,pixelRatio:i}}))}}
//# sourceMappingURL=/sm/9e279607aef649a84256e3be00a234dc5bd03b1c8d56e8ebb9b5bd5c3bd7e39b.map