/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/ol@8.1.0/interaction/Select.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import Collection from"../Collection.js";import CollectionEventType from"../CollectionEventType.js";import Event from"../events/Event.js";import Feature from"../Feature.js";import Interaction from"./Interaction.js";import VectorLayer from"../layer/Vector.js";import{TRUE}from"../functions.js";import{clear}from"../obj.js";import{createEditingStyle}from"../style/Style.js";import{extend}from"../array.js";import{getUid}from"../util.js";import{never,shiftKeyOnly,singleClick}from"../events/condition.js";const SelectEventType={SELECT:"select"};export class SelectEvent extends Event{constructor(e,t,i,r){super(e),this.selected=t,this.deselected=i,this.mapBrowserEvent=r}}const originalFeatureStyles={};class Select extends Interaction{constructor(e){let t;if(super(),this.on,this.once,this.un,e=e||{},this.boundAddFeature_=this.addFeature_.bind(this),this.boundRemoveFeature_=this.removeFeature_.bind(this),this.condition_=e.condition?e.condition:singleClick,this.addCondition_=e.addCondition?e.addCondition:never,this.removeCondition_=e.removeCondition?e.removeCondition:never,this.toggleCondition_=e.toggleCondition?e.toggleCondition:shiftKeyOnly,this.multi_=!!e.multi&&e.multi,this.filter_=e.filter?e.filter:TRUE,this.hitTolerance_=e.hitTolerance?e.hitTolerance:0,this.style_=void 0!==e.style?e.style:getDefaultStyleFunction(),this.features_=e.features||new Collection,e.layers)if("function"==typeof e.layers)t=e.layers;else{const i=e.layers;t=function(e){return i.includes(e)}}else t=TRUE;this.layerFilter_=t,this.featureLayerAssociation_={}}addFeatureLayerAssociation_(e,t){this.featureLayerAssociation_[getUid(e)]=t}getFeatures(){return this.features_}getHitTolerance(){return this.hitTolerance_}getLayer(e){return this.featureLayerAssociation_[getUid(e)]}setHitTolerance(e){this.hitTolerance_=e}setMap(e){this.getMap()&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),super.setMap(e),e?(this.features_.addEventListener(CollectionEventType.ADD,this.boundAddFeature_),this.features_.addEventListener(CollectionEventType.REMOVE,this.boundRemoveFeature_),this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))):(this.features_.removeEventListener(CollectionEventType.ADD,this.boundAddFeature_),this.features_.removeEventListener(CollectionEventType.REMOVE,this.boundRemoveFeature_))}addFeature_(e){const t=e.element;if(this.style_&&this.applySelectedStyle_(t),!this.getLayer(t)){const e=this.getMap().getAllLayers().find((function(e){if(e instanceof VectorLayer&&e.getSource()&&e.getSource().hasFeature(t))return e}));e&&this.addFeatureLayerAssociation_(t,e)}}removeFeature_(e){this.style_&&this.restorePreviousStyle_(e.element)}getStyle(){return this.style_}applySelectedStyle_(e){const t=getUid(e);t in originalFeatureStyles||(originalFeatureStyles[t]=e.getStyle()),e.setStyle(this.style_)}restorePreviousStyle_(e){const t=this.getMap().getInteractions().getArray();for(let i=t.length-1;i>=0;--i){const r=t[i];if(r!==this&&r instanceof Select&&r.getStyle()&&-1!==r.getFeatures().getArray().lastIndexOf(e))return void e.setStyle(r.getStyle())}const i=getUid(e);e.setStyle(originalFeatureStyles[i]),delete originalFeatureStyles[i]}removeFeatureLayerAssociation_(e){delete this.featureLayerAssociation_[getUid(e)]}handleEvent(e){if(!this.condition_(e))return!0;const t=this.addCondition_(e),i=this.removeCondition_(e),r=this.toggleCondition_(e),s=!t&&!i&&!r,n=e.map,o=this.getFeatures(),l=[],a=[];if(s){clear(this.featureLayerAssociation_),n.forEachFeatureAtPixel(e.pixel,((e,t)=>{if(e instanceof Feature&&this.filter_(e,t))return this.addFeatureLayerAssociation_(e,t),a.push(e),!this.multi_}),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let e=o.getLength()-1;e>=0;--e){const t=o.item(e),i=a.indexOf(t);i>-1?a.splice(i,1):(o.remove(t),l.push(t))}0!==a.length&&o.extend(a)}else{n.forEachFeatureAtPixel(e.pixel,((e,s)=>{if(e instanceof Feature&&this.filter_(e,s))return!t&&!r||o.getArray().includes(e)?(i||r)&&o.getArray().includes(e)&&(l.push(e),this.removeFeatureLayerAssociation_(e)):(this.addFeatureLayerAssociation_(e,s),a.push(e)),!this.multi_}),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let e=l.length-1;e>=0;--e)o.remove(l[e]);o.extend(a)}return(a.length>0||l.length>0)&&this.dispatchEvent(new SelectEvent(SelectEventType.SELECT,a,l,e)),!0}}function getDefaultStyleFunction(){const e=createEditingStyle();return extend(e.Polygon,e.LineString),extend(e.GeometryCollection,e.LineString),function(t){return t.getGeometry()?e[t.getGeometry().getType()]:null}}export default Select;
//# sourceMappingURL=/sm/ca6a20bc1cbe1e19f2cc64c2ff1776acbbe6f93d6ba46a3156e4ca0acf7488ef.map